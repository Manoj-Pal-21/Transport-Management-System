(function($,window,undefined){'use strict';var Modernizr=window.Modernizr;var msGesture=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture;var touchMode=(("ontouchstart" in window)||msGesture||window.DocumentTouch&&document instanceof DocumentTouch);var thumbsData=[];var pmContainer=null;var pmSlider=null;var pmSlidesContainer=null;var pmImages=[];var slideshowTimer;var currAnimSlide=0;var initPageX=0;var trackTouch=0;$.PMSlider=function(options,element){this.$el=$(element);this._init(options)};$.PMSlider.defaults={speed:500,easing:'ease',loop:!1,controlNav:'thumbnails',controlNavThumbs:!1,animation:'fade',fullScreen:!1,slideshow:!1,slideshowSpeed:8000,pauseOnHover:!1,arrows:!0,fixedHeight:!1,fixedHeightValue:800,touch:!0,progressBar:!1};$.PMSlider.prototype={_init:function(options){this.options=$.extend(!0,{},$.PMSlider.defaults,options);this._config();this._initEvents();this._initFullScreen();this._slideShow()},_config:function(){var parent=this;this.$list=this.$el.children('ul');if(this.options.loop&&this.options.animation=='slide'){var $firstChild=this.$list.children('li:first-child');var $lastChild=this.$list.children('li:last-child');this.$list.append($firstChild.clone(!0).addClass('clone')).prepend($lastChild.clone(!0).addClass('clone'))}
this.$items=this.$list.children('li');this.itemsCount=this.$items.length;$('#pm-slider ul li img').each(function(index,element){var $el=$(element);pmImages.push($el)});this.$items.each(function(i,el){var $el=$(el);var titleWidth=$el.find('h1').width();var captionWidth=$el.find('.pm-caption-decription').width();$el.data("properties",{"titleWidth":titleWidth,"captionWidth":captionWidth})});if(this.options.animation=='fade'){this.$items.each(function(i,el){var $this=$(el);if(i!=0){$this.fadeOut('fast')}})}
if(this.options.controlNav=='thumbnails'){this.$items.each(function(i,el){var $this=$(el);thumbsData.push($this.data('thumb'))});if(this.options.loop&&this.options.animation=='slide'){thumbsData.splice(0,1);thumbsData.splice(this.itemsCount-2,1)}}
this.support=Modernizr.csstransitions&&Modernizr.csstransforms;this.support3d=Modernizr.csstransforms3d;var transEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd','msTransition':'MSTransitionEnd','transition':'transitionend'},transformNames={'WebkitTransform':'-webkit-transform','MozTransform':'-moz-transform','OTransform':'-o-transform','msTransform':'-ms-transform','transform':'transform'};if(this.support){this.transEndEventName=transEndEventNames[Modernizr.prefixed('transition')]+'.PMSlider';this.transformName=transformNames[Modernizr.prefixed('transform')]}
this.current=0;this.old=0;if(this.options.loop&&this.options.animation=='slide'){var translateVal=-1*(this.current++)*100/this.itemsCount;this.$list.css('margin-left',-1*this.current*100+'%');this.current--}
this.isAnimating=!1;this.$list.css('width',100*this.itemsCount+'%');if(this.options.fixedHeight){this.$list.css({'position':'relative'});this.$items.find('img').css({'maxWidth':'inherit'});this.$items.css({'height':this.options.fixedHeightValue+'px'})}
if(this.support&&this.options.animation=='slide'){this.$list.css('transition',this.transformName+' '+this.options.speed+'ms '+this.options.easing)}
this.$items.css('width',100/this.itemsCount+'%');if(this.itemsCount>1){if(this.options.controlNav===!0){var dots='';var len=this.options.loop&&this.options.animation=='slide'?this.itemsCount-2:this.itemsCount;for(var i=0;i<len;++i){var dot=i===this.current?'<span class="pm-currentDot"></span>':'<span></span>';dots+=dot}
var navDots=$('<div class="pm-dots"/>').append(dots).appendTo(this.$el);this.$navDots=navDots.children('span');if(this.options.arrows){$('.pm-dots').prepend('<div class="pm-prev reset-pulse-sizing"><i class="fa fa-angle-left"></i></div>');$('.pm-dots').append('<div class="pm-next reset-pulse-sizing"><i class="fa fa-angle-right"></i></div>')}
if(this.options.controlNavThumbs===!0){this.$navDots.each(function(i,el){$(this).hover(function(e){var thumbData=$('.pmslide_'+i).data('thumb');if(thumbData!=''){parent._toolTip(thumbData,this)}},function(e){var thumbData=$('.pmslide_'+i).data('thumb');if(thumbData!=''){$("#pm_slider_tooltip").remove()}})})}}else if(this.options.controlNav=='thumbnails'){var thumbs='';var len=this.options.loop&&this.options.animation=='slide'?this.itemsCount-2:this.itemsCount;for(var i=0;i<len;++i){var thumb=i===this.current?'<span class="pm-currentThumb"><img src="'+thumbsData[i]+'" /></span>':'<span><img src="'+thumbsData[i]+'" /></span>';thumbs+=thumb}
var navThumbs=$('<div class="pm-thumbs"/>').append(thumbs).appendTo(this.$el);this.$navThumbs=navThumbs.children('span')}else{}
if(!this.options.loop&&this.options.animation=='slide'){this.$navPrev=$('.pm-prev').hide()}else if(!this.options.loop&&this.options.animation=='fade'){this.$navPrev=$('.pm-prev').hide()}else{this.$navPrev=$('.pm-prev').show()}
this.$navNext=$('.pm-next')}
if(this.options.fixedHeight){this.$items.find('img').remove();this.$items.each(function(index,element){var $this=$(element);$this.css({'backgroundImage':'url('+pmImages[index].attr('src')+')','backgroundPosition':'center center'})})};if(msGesture&&this.options.touch){this._activateMSTouch()}else if(touchMode&&this.options.touch){this._activateTouch()};if(this.options.arrows){if(this.options.animation=='fade'){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}else if(!this.options.loop){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}else{$('.pm-slide-count').html((this.current+1)+' / '+(this.itemsCount-2))}
var btnHeight=$('.pm-next').height();var btnWidth=$('.pm-next').width()};parent._resetAnimation();if(parent.options.animation=='slide'&&!parent.options.loop){$('#pm-pulse-loader').hide();$('#pm-slider').css({height:'auto'});$('#pm-slider').animate({opacity:1});parent._animateSlide(this.current)}else if(parent.options.animation=='slide'){$('#pm-slider').css({height:'auto'});$('#pm-slider').animate({opacity:1},500,function(e){parent._animateSlide(parent.current)});$('#pm-pulse-loader').hide()}else{$('#pm-pulse-loader').hide();$('#pm-slider').css({height:'auto'});$('#pm-slider').animate({opacity:1});parent._animateSlide(this.current)}},_animateSlide:function(currSlide){var $slide=$('.pmslide_'+currSlide);var title=$slide.find('h1');var subTitle=$slide.find('h2');var caption=$slide.find('.pm-caption-decription');var btn=$slide.find('.pm-slide-btn');var excerpt=$slide.find('.pm-caption-excerpt');var captionBg=$slide.find('.pm-caption');if(captionBg.length>0){captionBg.css('transition','all .6s ease 0s');captionBg.css({'backgroundPosition':"center 0px",'opacity':1,})}
if(excerpt.length>0){excerpt.css('transition','all .9s ease 0s');excerpt.css({'opacity':1,})}
if(title.length>0){title.css('transition','all .6s ease 0s');title.css({'opacity':1,marginTop:0})}
if(subTitle.length>0){subTitle.css('transition','all .6s ease 0s');subTitle.css({'opacity':1,marginLeft:0})}
if(caption.length>0){caption.css('transition','all .6s ease 0s');caption.css({'opacity':1,marginLeft:0})}
if(btn.length>0){btn.css('transition','all .6s ease 0s');btn.css({'opacity':1,'marginTop':0,})}},_resetAnimation:function(){var parent=this;this.$items.each(function(i,el){var $el=$(el);var title=$el.find('h1');var subTitle=$el.find('h2');var caption=$el.find('.pm-caption-decription');var btn=$el.find('.pm-slide-btn');var excerpt=$el.find('.pm-caption-excerpt');var captionBg=$el.find('.pm-caption');if(captionBg.length>0){captionBg.css('transition','all .6s ease 0s');captionBg.css({'backgroundPosition':"center 50px",'opacity':0,})}
if(excerpt.length>0){excerpt.css('transition','all .9s ease 0s');excerpt.css({'opacity':0,})}
if(title.length>0){title.finish().css({'opacity':0,marginTop:-50})}
if(subTitle.length>0){subTitle.finish().css({'opacity':0,'marginLeft':0})}
if(caption.length>0){caption.finish().css({'opacity':0,'marginLeft':0})}
if(btn.length>0){btn.finish().css({'opacity':0,'marginTop':150},0)}})},_activateTouch:function(){var parent=this;this.$items.each(function(i,el){el.addEventListener('touchstart',onTouchStart,!1);el.addEventListener('touchmove',onTouchMove,!1);el.addEventListener('touchend',onTouchEnd,!1);function onTouchStart(event){var touches=event.changedTouches,first=touches[0];initPageX=first.pageX;$('#pm-touchstart').html('Touch start = '+initPageX);var simulatedEvent=document.createEvent('MouseEvent');simulatedEvent.initMouseEvent(type,!0,!0,window,1,first.screenX,first.screenY,first.clientX,first.clientY,!1,!1,!1,!1,0,null);first.target.dispatchEvent(simulatedEvent);event.preventDefault()};function onTouchMove(event){var touches=event.changedTouches,first=touches[0];trackTouch=first.pageX};function onTouchEnd(event){if(trackTouch>initPageX+60){$('#pm-swipe').html('Swiping right');parent._executeTouch('right')}
if(trackTouch<initPageX-60){$('#pm-swipe').html('Swiping left');parent._executeTouch('left')}}})},_activateMSTouch:function(){var parent=this;this.$items.each(function(i,el){el.style.msTouchAction="none";var g=new MSGesture();g.target=el;el.addEventListener("MSPointerDown",assignPointer,!1);el.addEventListener("MSGestureChange",onMSGestureChange,!1);el.addEventListener("MSGestureEnd",onMSGestureEnd,!1);function assignPointer(e){try{g.target=e.target}catch(err){}
if(e.target==g.target){g.addPointer(e.pointerId);initPageX=e.screenX;$('#pm-touchstart').html('MS Touch start = '+initPageX)}
e.stopPropagation()};function onMSGestureChange(e){trackTouch=e.screenX;$('#pm-touchmove').html('MS Touch move = '+e.screenX+' and Touch start = '+initPageX);e.preventDefault()};function onMSGestureEnd(e){if(trackTouch>initPageX+30){$('#pm-swipe').html('Swiping right');parent._executeTouch('right')}
if(trackTouch<initPageX-30){$('#pm-swipe').html('Swiping left');parent._executeTouch('left')}}})},_executeTouch:function(direction){switch(direction){case 'right':if(this.options.animation=='slide'){this._navigate('previous')}else if(this.options.animation=='fade'){this._navigate('next')}
break;case 'left':if(this.options.animation=='slide'){this._navigate('next')}else if(this.options.animation=='fade'){this._navigate('previous')}
break}},_initFullScreen:function(){var parent=this;if(this.options.fullScreen){pmContainer=$('#pm-container');pmContainer.css({"overflow":"hidden","width":"100%","position":"relative"});pmSlider=$('#pm-slider');pmSlider.css({"height":"100%","position":"relative","width":"100%"});pmSlidesContainer=$('.pm-slides-container');pmSlidesContainer.children().css({"overflow":"hidden","height":"100%","position":"absolute","top":"0"});pmSlidesContainer.children().css({"height":"100%","position":"relative"});$.each(pmImages,function(index,value){value.css({"max-width":"none","left":"0","top":"0","position":"absolute","z-index":"-1"})});var $window=$(window);this._checkWidth();$window.resize(this._checkWidth)}},_checkWidth:function(){var parent=this;setTimeout(function(){var $window=$(window);var $windowWidth=0;var $windowHeight=0;$windowWidth=$window.width();$windowHeight=$window.height();pmContainer.height($windowHeight);pmSlidesContainer.height($windowHeight);$.each(pmImages,function(index,value){var img=value;var imgWidth=img.width();var imgHeight=img.height();var container_aspect_ratio=$windowHeight/$windowWidth;var image_aspect_ratio=imgHeight/imgWidth;if(container_aspect_ratio>image_aspect_ratio){img.css({height:$windowHeight,width:$windowHeight/image_aspect_ratio,})}else{img.css({height:$windowWidth*image_aspect_ratio,width:$windowWidth,})}
img.css({left:($windowWidth-pmSlidesContainer.children().find('img').width())/4,top:($windowHeight-pmSlidesContainer.children().find('img').height())/4,})})},10)},_initEvents:function(){var parent=this;if(this.itemsCount>1){this.$navPrev.on('click.PMSlider',$.proxy(this._navigate,this,'previous'));this.$navNext.on('click.PMSlider',$.proxy(this._navigate,this,'next'));if(this.options.controlNav===!0){this.$navDots.on('click.PMSlider',function(e){if(parent.options.arrows){parent._jump($(this).index()-1)}else{parent._jump($(this).index())}})}else if(this.options.controlNav==='thumbnails'){this.$navThumbs.on('click.PMSlider',function(e){if(parent.options.arrows){parent._jump($(this).index()-1)}else{parent._jump($(this).index())}})}else{}}},_navigate:function(direction){var parent=this;if(this.isAnimating||this.itemsCount==1){return!1}
if(this.options.loop&&this.options.animation=='slide'&&this.itemsCount==3){return!1}
this.isAnimating=!0;parent._resetAnimation();if(this.options.slideshow){if(this.current==this.itemsCount-1&&direction=='next'){this.old=this.itemsCount-1
this.current=-1}else{this.old=this.current}}else{this.old=this.current}
if(direction==='next'&&this.current<=this.itemsCount){++this.current;if(this.options.loop&&this.options.animation=='fade'){if(this.current>=this.itemsCount){this.current=0}}}
else if(direction==='previous'&&this.current>=0){--this.current;if(this.options.loop&&this.options.animation=='fade'){if(this.current==-1){this.current=this.itemsCount-1}}}
if(this.options.animation=='slide'){this._slide()}
if(this.options.animation=='fade'){this._fade()}
if(this.options.loop&&this.options.animation=='slide'){if((this.current+1)>(this.itemsCount-2)){$('.pm-slide-count').html('1 / '+(this.itemsCount-2))}else if((this.current)<0){$('.pm-slide-count').html((this.itemsCount-2)+' / '+(this.itemsCount-2))}else{$('.pm-slide-count').html((this.current+1)+' / '+(this.itemsCount-2))}}else if(!this.options.loop){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}else if(this.options.animation=='fade'){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}},_runSlideShow:function(status){var parent=this;if(status=='start'){clearTimeout(slideshowTimer);$('#pm-slider-progress-bar').remove();$('#pm-slider').append('<div id="pm-slider-progress-bar"></div>');if(!parent.options.progressBar){$('#pm-slider-progress-bar').css({display:'none'})}
slideshowTimer=setTimeout(function(){if(!parent.isAnimating){return parent._autoplay()}},this.options.slideshowSpeed)}else if(status=='pause'){clearTimeout(slideshowTimer)}else if(status=='resume'){slideshowTimer=setTimeout(function(){if(!parent.isAnimating){return parent._autoplay()}},this.options.slideshowSpeed)}},_slideShow:function(){var parent=this;if(this.options.slideshow){if(this.options.animation==='slide'&&this.itemsCount>3){parent._runSlideShow('start')}else if(this.options.animation==='fade'&&this.itemsCount>1){parent._runSlideShow('start')}
parent._bindMouseEvents()}},_bindMouseEvents:function(){var parent=this;if(this.options.pauseOnHover){$('#pm-slider').bind('mouseenter mouseleave mousemove',function(event){if(event.type=='mouseenter'){parent._runSlideShow('pause')}else if(event.type=='mouseleave'){parent._runSlideShow('resume')}else if(event.type=='mousemove'){parent._runSlideShow('pause')}})}},_autoplay:function(){this._navigate('next');this._runSlideShow('start')},_toggleNavControls:function(){if(this.options.loop&&this.options.animation=='slide'){this.$list.css({'transition':this.transformName+' '+this.options.speed+'ms '+this.options.easing+' 0s'})}
switch(this.current){case 0:if(!this.options.loop){this.$navNext.show();this.$navPrev.hide()}else{this.$navNext.show();this.$navPrev.show()}
break;case this.itemsCount-1:if(!this.options.loop){this.$navNext.hide();this.$navPrev.show()}else{this.$navNext.show();this.$navPrev.show()}
break;default:this.$navNext.show();this.$navPrev.show();break}
if(this.options.loop&&this.options.animation=='slide'){if(this.options.controlNav===!0){if((this.current+2)>=this.itemsCount){this.$navDots.eq(this.old).removeClass('pm-currentDot').end().eq(0).addClass('pm-currentDot')}else{this.$navDots.eq(this.old).removeClass('pm-currentDot').end().eq(this.current).addClass('pm-currentDot')}}else if(this.options.controlNav==='thumbnails'){if((this.current+2)>=this.itemsCount){this.$navThumbs.eq(this.old).removeClass('pm-currentThumb').end().eq(0).addClass('pm-currentThumb')}else{this.$navThumbs.eq(this.old).removeClass('pm-currentThumb').end().eq(this.current).addClass('pm-currentThumb')}}else{}}else if(this.options.loop&&this.options.animation=='fade'){if(this.options.controlNav===!0){if(this.current>=this.itemsCount){this.$navDots.eq(this.old).removeClass('pm-currentDot').end().eq(0).addClass('pm-currentDot')}else{this.$navDots.eq(this.old).removeClass('pm-currentDot').end().eq(this.current).addClass('pm-currentDot')}}else if(this.options.controlNav==='thumbnails'){if(this.current>=this.itemsCount){this.$navThumbs.eq(this.old).removeClass('pm-currentThumb').end().eq(0).addClass('pm-currentThumb')}else{this.$navThumbs.eq(this.old).removeClass('pm-currentThumb').end().eq(this.current).addClass('pm-currentThumb')}}else{}}else{if(this.options.controlNav===!0){this.$navDots.eq(this.old).removeClass('pm-currentDot').end().eq(this.current).addClass('pm-currentDot')}else if(this.options.controlNav==='thumbnails'){this.$navThumbs.eq(this.old).removeClass('pm-currentThumb').end().eq(this.current).addClass('pm-currentThumb')}else{}}},_fade:function(){var parent=this;this._toggleNavControls();var $list=this.$el.children('ul');var $items=this.$list.children('li');var current=this.current;var old=this.old;var speed=this.options.speed;$items.each(function(i,el){var $this=$(el);if(i==old){$this.fadeOut(speed,fadeComplete)}});function fadeComplete(){$items.each(function(i,el){var $this=$(el);if(i==current){$this.fadeIn(speed,transitionendfn)}})}
var transitionendfn=$.proxy(function(){this.isAnimating=!1;parent._animateSlide(this.current);if(parent.options.slideshow){parent._runSlideShow('start')}},this)},_slide:function(){var parent=this;this._toggleNavControls();var $list=this.$el.children('ul');var $items=this.$list.children('li');var translateVal=-1*this.current*100/this.itemsCount;if(this.support){this.$list.css(this.transformName,this.support3d?'translate3d('+translateVal+'%,0,0)':'translate('+translateVal+'%)')}else{$list.animate({'left':-1*this.current*100+'%'},this.options.speed,function(){if(!$(this).is('animated')){transitionendfn.call();if(parent.options.slideshow){parent._runSlideShow('start')}}})}
var transitionendfn=$.proxy(function(){this.isAnimating=!1;if(this.options.loop&&this.options.animation=='slide'){if((this.current+2)>=this.itemsCount){this.current=0;this.old=0;var translateVal=-1*(this.current)*100/this.itemsCount;if(this.support){this.$list.css('transition',this.transformName+' 0ms ease 0s');this.$list.css(this.transformName,this.support3d?'translate3d('+translateVal+',0,0)':'translate('+translateVal+'px)')}else{$list.css({'left':translateVal+'%'},this.options.speed)}}else if(this.current<0){this.current=this.itemsCount-3;this.old=this.current;var translateVal=-1*(this.current)*100/this.itemsCount;if(this.support){this.$list.css('transition',this.transformName+' 0ms ease 0s');this.$list.css(this.transformName,this.support3d?'translate3d('+translateVal+'%,0,0)':'translate('+translateVal+'%)')}else{$list.css({'left':-1*(this.current)*100+'%'},this.options.speed)}}}
if(this.options.loop){if(this.current<0){parent._animateSlide(this.itemsCount-3)}else if(this.current>=this.itemsCount-2){parent._animateSlide(0)}else{parent._animateSlide(this.current)}}else{parent._animateSlide(this.current)}
if(parent.options.slideshow){parent._runSlideShow('start')}},this);if(this.support){this.$list.on(this.transEndEventName,$.proxy(transitionendfn,this))}},_jump:function(position){var parent=this;if(position===this.current||this.isAnimating){return!1}
this.isAnimating=!0;this.old=this.current;this.current=position;if(this.options.loop&&this.options.animation=='slide'){$('.pm-slide-count').html((this.current+1)+' / '+(this.itemsCount-2))}else if(!this.options.loop){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}else if(this.options.animation=='fade'){$('.pm-slide-count').html((this.current+1)+' / '+this.itemsCount)}
if(this.options.animation=='slide'){this._slide()}
if(this.options.animation=='fade'){this._fade()}
parent._resetAnimation()},_toolTip:function(toolTipData,el){var parent=this;var $el=$(el);var yOffset=$("#pm_slider_tooltip").height()+80;var xOffset=$("#pm_slider_tooltip").width()+12;$("body").append("<div id='pm_slider_tooltip'>"+toolTipData+"</div>");$("#pm_slider_tooltip").css({"top":($el.pageY-xOffset)+"px","left":($el.pageX+yOffset)+"px",});$('#pm_slider_tooltip').css("top",($el.offset().top-yOffset)+"px").css("left",+($el.offset().left-xOffset)+"px").css({marginTop:0,opacity:1});$('#pm_slider_tooltip').html('<img src="'+toolTipData+'" />')},destroy:function(){if(this.itemsCount>1){this.$navPrev.parent().remove();if(this.options.controlNav==!0){this.$navDots.parent().remove()}else if(this.options.controlNav=='thumbnails'){this.$navThumbs.parent().remove()}else{}}
this.$list.css('width','auto');if(this.support){this.$list.css('transition','none')}
this.$items.css('width','auto')}};var logError=function(message){if(window.console){window.console.error(message)}};$.fn.PMSlider=function(options){if(typeof options==='string'){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,'PMSlider');if(!instance){logError("cannot call methods on PMSlider prior to initialization; "+"attempted to call method '"+options+"'");return}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+"' for PMSlider instance");return}
instance[options].apply(instance,args)})}else{this.each(function(){var instance=$.data(this,'PMSlider');if(instance){instance._init()}
else{instance=$.data(this,'PMSlider',new $.PMSlider(options,this))}})}
return this}})(jQuery,window)